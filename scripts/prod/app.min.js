$(document).ready(function(){var d=new Date();var b=(d.toDateString());function c(f){var e=new Date(1970,0,1);e.setSeconds(f);return e.toTimeString().replace(/.*(\d{2}:\d{2}).*/,"$1")}const a=firebase.database().ref();a.on("value",function(g){var k=g.val();$.each(k.tasks,function(l,m){if($.inArray("work",m.tags)>-1){$("#work-task-list").append("<li><button class='btn btn-outline task-btn' id='"+m.id+"' name='"+m.title+"' data-origin='work'>"+m.title+"</button></li>")}else{if($.inArray("personal",m.tags)>-1){$("#personal-task-list").append("<li><button class='btn btn-outline task-btn' id='"+m.id+"' name='"+m.title+"' data-origin='personal'>"+m.title+"</button></li>")}}});$.each(k.moods,function(l,m){$(".mood-list").append("<li><button class='btn btn-outline mood-btn' id='"+m.id+"' name='"+m.name+"'>"+m.name+"</button></li>")});console.log(currentUser);$.each(k.users,function(l,m){if(l===currentUser){console.log(m.name);$("#totalAudioTime").html(m.totalAudioTime);$("#streak").html(m.streak);return false}});var j;var e;var f;var h;var i;$(".task-btn").click(function(){j=$(this).attr("id");e=$(this).attr("name");f=$(this).attr("data-origin");changeView("#moods");$("#moodsBack").attr("data-destination",f);$(".upcoming-task").html(e);$("#moodList .mood-btn").click(function(){h=$(this).attr("id");i=$(this).attr("name");var l;changeView("#audio");$(".current-mood").html(i);$.each(k.audios,function(m,n){if($.inArray(j,n.tags)>-1&&$.inArray(h,n.tags)>-1){$(".audio-name").html(n.title);l=$("#kfAudio");l.attr("src","/audio/"+n.fileName);return false}else{$(".audio-name").html("Oops, we haven't uploaded an appropriate audio yet!")}});l.on("canplay",function(m){m.stopImmediatePropagation();$("#audioTotalTime").html(c(this.duration))});$(".play-pause").click(function(){if(l.get(0).paused==false){l.get(0).pause();$(".play-pause i").removeClass("fa-pause").addClass("fa-play");$(".audio-progress").stop()}else{l.get(0).play();$(".play-pause i").removeClass("fa-play").addClass("fa-pause")}});$(".seekbar").mouseover(function(){$(this).css("cursor","pointer")});$(".seekbar").click(function(p){var m=p.pageX-$(this).offset().left;var n=$(this).width();var o=l.get(0).duration;l.get(0).currentTime=m/n*o});l.on("timeupdate",function(){$("#audioPlayedTime").html(c(this.currentTime));$(".audio-progress").width(l.get(0).currentTime/l.get(0).duration*100+"%")});l.on("ended",function(){$(".play-pause i").removeClass("fa-pause").addClass("fa-play");changeView("#postAudioMood");$("#postAudioMoodList .mood-btn").click(function(){changeView("#analytics")})})})})})});